<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	  xmlns:th="http://www.thymeleaf.org">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>Workspace Management System |Utilization Report</title>
	
	<meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
	
	<link rel="stylesheet" th:href="@{/css/bootstrap.min.css}">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.5.0/css/font-awesome.min.css">

	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ionicons/2.0.1/css/ionicons.min.css">

  	<link rel="stylesheet" th:href="@{/css/dataTables.bootstrap.css}">
	
	<link rel="stylesheet" th:href="@{/css/AdminLTE.min.css}">
	<link rel="stylesheet" th:href="@{/css/style.css}">
	
    <link rel="stylesheet" th:href="@{/css/_all-skins.min.css}">
    <link rel="stylesheet" th:href="@{/css/datepicker3.css}">
	
	<link rel="stylesheet" th:href="@{/css/blue.css}">
	
	<link rel="stylesheet" th:href="@{/css/morris.css}">
	
	<link rel="stylesheet" th:href="@{/css/bootstrap3-wysihtml5.min.css}">
	<link rel="icon" type="image/png" sizes="16x16" th:href="@{/images/favicon.png}"/>
	
</head>
<style>
.js-legend ul {
  list-style: none;
}

.js-legend ul li {
  display: block;
  padding-left: 30px;
  position: relative;
  margin-bottom: 4px;
  border-radius: 5px;
  padding: 2px 8px 2px 28px;
  font-size: 14px;
  cursor: default;
  -webkit-transition: background-color 200ms ease-in-out;
  -moz-transition: background-color 200ms ease-in-out;
  -o-transition: background-color 200ms ease-in-out;
  transition: background-color 200ms ease-in-out;
}

.js-legend li span {
  display: block;
  position: absolute;
  left: 0;
  top: 0;
  width: 20px;
  height: 100%;
  border-radius: 5px;
}

</style>
<body class="hold-transition skin-blue sidebar-mini">
 <div class="se-pre-con"></div>
<div class="wrapper">
<input type="hidden"  name="gid" id="gid" th:value="${auth.gid}">
	<header class="main-header">
		
		<a th:href="@{/home}" class="logo">
			
			<span class="logo-mini"><b>W</b>MS</span>
			
			<span class="logo-lg" th:utext="${auth.role.role}"> </span>

		</a>
		
	  <nav class="navbar navbar-static-top">
          

            <div class="navbar-custom-menu">
                <ul class="nav navbar-nav">
                
                  
                    <li class=" user user-menu">
                     <img th:src="@{/images/avatar5.png}" class="user-image" alt="User Image">
                       
                        <ul class="dropdown-menu">
                          
                            <li class="user-header">
                                <img th:src="@{/images/avatar5.png}" class="img-circle" alt="User Image">

                                <p>
                                    <span class="hidden-xs" th:utext="${auth.name}"></span>
                                    <small><span class="hidden-xs" th:utext="${auth.email}"></span></small>
                                </p>
                            </li>
                           
                            <li class="user-footer">
                               
                            </li>
                        </ul>
                    </li>
                    <li>
            <a href="#" data-toggle="control-sidebar"><i class="fa fa-gear"></i></a>
          </li>
                </ul>
            </div>
        </nav>
	</header>
	
	<aside class="main-sidebar" th:insert="/navigator.html"></aside>

 
  <div class="content-wrapper">
   
    <section class="content">
      <div class="row">
        <div class="col-xs-12">
          <div class="box box-primary">
            <div class="box-header">
              <h3 class="box-title">Utilization Report</h3>
            </div>
           
            <div class="box-body">
              <table id="example1" class="table table-bordered table-striped">
				<thead>
					<tr>
						<th>Division</th>
						<th>Project Name</th>
						<th>Vacant</th>
						 <th>Allocated</th>
						<th>Assigned</th>
						<th>Utilized</th>
					</tr>
				</thead>
				
				
				
				</table>
            </div>
            
          </div>
       
        </div>
     
      </div>
     
    </section>
   
  </div>
  <footer class="main-footer">
    <div class="pull-right hidden-xs">
      <a th:href="@{/home}">Workspace Management System</a>
    </div>
    Copyright &copy; 2019 <strong>Four Corners Technologies</strong> All rights
    reserved.
  </footer>
  <div th:insert="/logout.html"></div>
  </div>


  
  
<!-- jQuery 2.2.3 -->
<script th:src="@{/js/jquery-2.2.3.min.js}"></script>
<!-- Bootstrap 3.3.6 -->
<script th:src="@{/js/bootstrap.min.js}"></script>
<!-- DataTables -->
<script th:src="@{/js/jquery.dataTables.min.js}"></script>
<script th:src="@{/js/dataTables.bootstrap.min.js}"></script>

<script src="https://cdn.datatables.net/buttons/1.6.0/js/dataTables.buttons.min.js"></script>
<script src="https://cdn.datatables.net/buttons/1.6.0/js/buttons.flash.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js"></script>
<script src="https://cdn.datatables.net/buttons/1.6.0/js/buttons.html5.min.js"></script>

<!-- FastClick -->
<script th:src="@{/js/fastclick.js}"></script>
<!-- AdminLTE App -->
<script th:src="@{/js/app.min.js}"></script>
<!-- AdminLTE for demo purposes -->
<script th:src="@{/js/demo.js}"></script>
<!-- jQuery UI 1.11.4 -->
<script th:src="@{/js/jquery-ui.min.js}"></script>
<!-- Slimscroll -->
<script th:src="@{/js/jquery.slimscroll.min.js}"></script>


<!-- Morris.js charts -->
<script th:src="@{/js/raphael-min.js}"></script>
<script th:src="@{/js/morris.min.js}"></script>
<!-- ChartJS -->
<script th:src="@{/js/Chart.min.js}"></script>
<!-- Sparkline -->
<script th:src="@{/js/jquery.sparkline.min.js}"></script>
<!-- jQuery Knob Chart -->
<script th:src="@{/js/jquery.knob.js}"></script>
<!-- Bootstrap WYSIHTML5 -->
<script th:src="@{/js/bootstrap3-wysihtml5.all.min.js}"></script>
<script th:src="@{/js/scripts.js}"></script>

<script th:inline="javascript">



$(function() {
	var table = $("#example1").DataTable({"order": [ 0, 'desc' ],dom: 'Bfrtip' , fnCreatedRow : function (nRow, aData, iDataIndex) {
        $(nRow).attr('class', aData[0] + '-' + iDataIndex); 
    },
        buttons: [
            'copy', 'csv', 'excel', 'pdf'
        ],"drawCallback": function ( settings ) {
          var api = this.api();
          var rows = api.rows( {page:'current'} ).nodes();
          var last=null;

          api.column(0, {page:'current'} ).data().each( function ( group, i ) {
              if ( last !== group ) {
                  $(rows).eq( i ).before(
                      '<tr class="group"><td colspan="8">'+group+'</td></tr>'
                  );
				 //console.log($(rows).eq(i));
                  last = group;
              }
          } );
      }});
	  
	// Order by the grouping
	    $('#example1 tbody').on( 'click', 'tr.group', function () {
	    	console.log($(this).text());
	    	var classVal = $(this).text();
	    	$("."+classVal).hide();
	       /*  var currentOrder = table.order()[0];
	        if ( currentOrder[0] === 2 && currentOrder[1] === 'asc' ) {
	            table.order( [ 0, 'desc' ] ).draw();
	        }
	        else {
	            table.order( [ 0, 'asc' ] ).draw();
	        } */
	    } );
	
	  $(document).ready(function(){
			loadData();
			var authemail = [[${auth.email}]];
			//console.log(authemail);
			$('#authemail').html(authemail);
		});

	  // Premade test data, you can also use your own
	  //var testDataUrl = "https://raw.githubusercontent.com/chennighan/RapidlyPrototypeJavaScript/master/lesson4/data.json"
	  var gid = $('#gid').val();
	  var allocationReqURL = "../floormap/reportlist?field=1";

	  function loadData() {
	    $.ajax({
	      type: 'GET',
	      url: allocationReqURL,
	      contentType: "application/json",
	      dataType: 'json',
	      success: function (data) {
	        myJsonData = data.utilizationReport;
	        console.log("myJsonData: " + myJsonData);
	        populateDataTable(myJsonData);
	        
	      },
	      error: function (e) {
	        console.log("There was an error with your request...");
	        console.log("error: " + JSON.stringify(e));
	      }
	    });
	  }

	  // populate the data table with JSON data
	  function populateDataTable(data) {
	    console.log("populating data table...");
	    // clear the table before populating it with more data
	    $("#example").DataTable().clear();
	    var length = Object.keys(data).length;
	    for(var i = 0; i < length; i++) {
	      var allocationReq = data[i];
	    	   $('#example1').dataTable().fnAddData( [
		 	    	  allocationReq.division,
		 	    	  allocationReq.projectName,
		 	    	  allocationReq.vacant,
		 	    	  allocationReq.allocated,
		 	    	 allocationReq.assigned,
		 	    	allocationReq.utilized
		 	      ]);
	      
	    }
	    
	  }
	})

</script>
</body>
</html>
